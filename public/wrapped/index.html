<!DOCTYPE html>
<html>
  <head>
    <link rel="icon" type="image/ico" href="https://michaelzhangwebsite.herokuapp.com/sFavicon.png">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167496422-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
      
      gtag('config', 'UA-167496422-1');
    </script>
    <link href='https://fonts.googleapis.com/css?family=Cabin' rel='stylesheet'>

    <title id="documentTitle">Your Wrapped for Cracked Spotify</title>
  </head>
  <body>
    <font style="font-family: 'Cabin';">
      <center>
        <h1>Total Time</h1>
        <br>
        <p id="time"></p>
        <br>
        <br>
        <p id="disc">As of this feature's release date, Saturday, February 26, 2022<br>at 8:41:26pm EST (or 01:41:26 UTC)</p>
      </center>
    </font>
    <style>
      #time{
        font-size:22px;
      }
      #disc{
        font-size:14px;
        opacity:50%;
      }
    </style>
    <script src="https://code.jquery.com/jquery-2.1.0.js"></script>
    <script src="https://michaelzhangwebsite.herokuapp.com/switchHTTPS.js"></script>
    <script>
      /**
       * Get the total time in String format
       * [time] is total time in milliseconds
      */
      var getTime = function(time){
        var cout = "";
        if(Math.floor(time/3600000)!==0)cout+=(Math.floor(time/3600000));if(Math.floor(time/3600000)==1)cout+=(" hour, ");else if(Math.floor(time/3600000)!==0)cout+=(" hours, ");time%=3600000;
        if(Math.floor(time/60000)!==0)cout+=(Math.floor(time/60000));if(Math.floor(time/60000)==1)cout+=(" minute, ");else if(Math.floor(time/60000)!==0)cout+=(" minutes, ");time%=60000;
        if(Math.floor(time/1000)!==0)cout+=(Math.floor(time/1000));if(Math.floor(time/1000)==1)cout+=(" second, ");else if(Math.floor(time/1000)!==0)cout+=(" seconds, ");time%=1000;
        cout+=("and "+time);if(time==1)cout+=(" millisecond");else cout+=(" milliseconds");
        return cout;
      }
      /**
       * Get the total time IN MINUTES in String format
       * [time] is total time in milliseconds
      */
      var getTimeMins = function(time){
        return parseInt((time)/60000);
      }
      if (localStorage.getItem("totalTime")===null||localStorage.getItem("totalTime")===undefined||localStorage.getItem("totalTime")===""){
        alert("Start listening to see how much total time you have listened for in the future!\nSending you home...");
        window.location=window.location.origin+"/spotifyYt";
      }else{
        var timeE = document.getElementById("time");
        //for curr year:
        const year = new Date().getUTCFullYear();
        timeE.append("You've listened for " + getTime(parseInt(localStorage.getItem("totalTime"+year))) + " this year in "+year+"!");
        //mins only
        timeE.append(document.createElement("br"));timeE.append(document.createElement("br"));
        timeE.append("You've listened for " + getTimeMins(parseInt(localStorage.getItem("totalTime"+year))) + " total minutes this year!");

        timeE.append(document.createElement("br"));timeE.append(document.createElement("br"));timeE.append(document.createElement("br"));
        
        //for all of time
        timeE.append("You've listened for " + getTime(parseInt(localStorage.getItem("totalTime"))) + " for all of time!");
        //mins only
        timeE.append(document.createElement("br"));timeE.append(document.createElement("br"));
        timeE.append("You've listened for " + getTimeMins(parseInt(localStorage.getItem("totalTime"))) + " total minutes!");
      }
    </script>
  </body>
</html>
